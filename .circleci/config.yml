# PHP CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-php/ for more details
#
version: 2

jobs:
  # build:
  #   docker:
  #     - image: circleci/php:7.1-browsers
  #
  #   working_directory: ~/repo
  #
  #   steps:
  #     - checkout
  #
  #     - run: echo "This is Circle CI test."

  # deploy:
  build:
    working_directory: ~/repo
    # working_directory: /src/Sample
    environment:
      - AWS_DEFAULT_REGION: ap-northeast-1
      - CODE_DEPLOY_S3_BUCKET_NAME: chiba-app
      - CODE_DEPLOY_APPLICATION_NAME: CodeDeploySampleApplication
      - CODE_DEPLOY_GROUP_NAME: CodeDeploySampleDeployGroup
      - APP_DIR: .
      # - APP_DIR: ./src
    docker:
      - image: innovatorjapan/awscli:latest
    steps:
      - attach_workspace:
          at: .
      - run: echo "Start Deploy"
      - run: sh /bin/aws-s3-deploy
